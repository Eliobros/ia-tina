const a0_0xa625d3=a0_0x24f0;(function(_0x3436e0,_0x4430c2){const _0x476a30=a0_0x24f0,_0x4dde1c=_0x3436e0();while(!![]){try{const _0x24d707=-parseInt(_0x476a30(0xf8))/0x1+parseInt(_0x476a30(0xef))/0x2+parseInt(_0x476a30(0x104))/0x3*(-parseInt(_0x476a30(0x10d))/0x4)+-parseInt(_0x476a30(0x114))/0x5+-parseInt(_0x476a30(0x105))/0x6*(parseInt(_0x476a30(0x108))/0x7)+parseInt(_0x476a30(0xfa))/0x8+parseInt(_0x476a30(0xf3))/0x9;if(_0x24d707===_0x4430c2)break;else _0x4dde1c['push'](_0x4dde1c['shift']());}catch(_0xb43f00){_0x4dde1c['push'](_0x4dde1c['shift']());}}}(a0_0x381a,0x2081a));const qrcode=require(a0_0xa625d3(0x107)),{Client,LocalAuth}=require('whatsapp-web.js'),axios=require(a0_0xa625d3(0xfc));require(a0_0xa625d3(0x101))[a0_0xa625d3(0xf5)]();function a0_0x381a(){const _0x37d41f=['qrcode-terminal','476KzOpAF','./models/Conversa','ready','from','@g.us','125580AohzRf','...','./lib/mongodb','conversation_id','initialize','error','fromMe','769215wAKUNJ','\x0a|->\x20Grupo:\x20Não\x0a===========================\x0a\x20\x20','trim','generate','\x0a|->\x20Hora:\x20','toLocaleDateString','53664vldOTu','\x0a|->\x20Mensagem:\x20','env','\x0a=========\x20Tina\x20IA\x20=========\x0a|->\x20Número:\x20','4897215UKsKYn','🤖\x20(sem\x20resposta\x20da\x20IA)','config','Bearer\x20','message','141111aiqUPA','https://api.dify.ai/v1/chat-messages','760976bGMbki','reply','axios','DIFY_API_KEY','log','toLocaleTimeString','slice','dotenv','✅\x20Tina\x20IA\x20conectada!','\x0a|->\x20Data:\x20','21vbwDVi','1608zkMdeq','data'];a0_0x381a=function(){return _0x37d41f;};return a0_0x381a();}const connectDB=require(a0_0xa625d3(0x10f)),Conversa=require(a0_0xa625d3(0x109));connectDB();const client=new Client({'authStrategy':new LocalAuth()});client['on']('qr',_0x4ce1bb=>{const _0x5807eb=a0_0xa625d3;qrcode[_0x5807eb(0x117)](_0x4ce1bb,{'small':!![]});}),client['on'](a0_0xa625d3(0x10a),()=>{const _0x2be57d=a0_0xa625d3;console[_0x2be57d(0xfe)](_0x2be57d(0x102));});async function enviarParaDify(_0x21a14d,_0x41d3dc,_0x29b94a=null){const _0xb83110=a0_0xa625d3;try{const _0x2d451d=await axios['post'](_0xb83110(0xf9),{'query':_0x21a14d,'response_mode':'blocking','user':_0x41d3dc,'conversation_id':_0x29b94a,'inputs':{}},{'headers':{'Authorization':_0xb83110(0xf6)+process[_0xb83110(0xf1)][_0xb83110(0xfd)],'Content-Type':'application/json'}});return _0x2d451d[_0xb83110(0x106)];}catch(_0x180b2c){return console[_0xb83110(0x112)]('❌\x20Erro\x20ao\x20enviar\x20para\x20Dify:',_0x180b2c[_0xb83110(0xf7)]),{'answer':'⚠️\x20Erro\x20na\x20IA.\x20Tente\x20mais\x20tarde.'};}}function a0_0x24f0(_0x2e9fa2,_0x212dcc){const _0x381a7d=a0_0x381a();return a0_0x24f0=function(_0x24f0ea,_0x11a7c0){_0x24f0ea=_0x24f0ea-0xed;let _0x32d1a1=_0x381a7d[_0x24f0ea];return _0x32d1a1;},a0_0x24f0(_0x2e9fa2,_0x212dcc);}client['on']('message_create',async _0x1e924a=>{const _0x51024a=a0_0xa625d3;if(_0x1e924a[_0x51024a(0x113)]||_0x1e924a[_0x51024a(0x10b)]['endsWith'](_0x51024a(0x10c)))return;const _0x52de3b=_0x1e924a['from']['split']('@')[0x0],_0x4e84e8=_0x1e924a['body']?.[_0x51024a(0x116)]();if(!_0x4e84e8)return;const _0x2ff318=_0x4e84e8['length']>0x2d?_0x4e84e8[_0x51024a(0x100)](0x0,0x2d)+_0x51024a(0x10e):_0x4e84e8;console[_0x51024a(0xfe)](_0x51024a(0xf2)+_0x52de3b+_0x51024a(0xf0)+_0x2ff318+_0x51024a(0xed)+new Date()[_0x51024a(0xff)]()+_0x51024a(0x103)+new Date()[_0x51024a(0xee)]()+_0x51024a(0x115));let _0x467d3a=await Conversa['findOne']({'numero':_0x52de3b});const _0x41ee87=await enviarParaDify(_0x4e84e8,_0x52de3b,_0x467d3a?.[_0x51024a(0x110)]);!_0x467d3a&&_0x41ee87['conversation_id']&&await Conversa['create']({'numero':_0x52de3b,'conversation_id':_0x41ee87[_0x51024a(0x110)]}),_0x467d3a&&_0x41ee87[_0x51024a(0x110)]&&_0x41ee87[_0x51024a(0x110)]!==_0x467d3a[_0x51024a(0x110)]&&(_0x467d3a['conversation_id']=_0x41ee87[_0x51024a(0x110)],await _0x467d3a['save']()),await _0x1e924a[_0x51024a(0xfb)](_0x41ee87['answer']||_0x51024a(0xf4));}),client[a0_0xa625d3(0x111)]();